<?php
/**
 * Multisite WordPress API
 *
 * @package WordPress
 * @subpackage Multisite
 * @since 3.0.0
 */

add_action('update_option_blog_public', 'update_blog_public', 10, 2);

add_filter('option_users_can_register', 'users_can_register_signup_filter');

add_filter( 'site_option_welcome_user_email', 'welcome_user_msg_filter' );








































































































/**
 * The number of active users in your installation.
 *
 * The count is cached and updated twice daily. This is not a live count.
 *
 * @since MU 2.7
 *
 * @return int
 */
function get_user_count() {
	return get_site_option( 'user_count' );
}

/**
 * The number of active sites on your installation.
 *
 * The count is cached and updated twice daily. This is not a live count.
 *
 * @since MU 1.0
 *
 * @param int $network_id Deprecated, not supported.
 * @return int
 */
function get_blog_count( $network_id = 0 ) {
	if ( func_num_args() )
		_deprecated_argument( __FUNCTION__, '3.1' );

	return get_site_option( 'blog_count' );
}



































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































/**
 * Update the network-wide users count.
 *
 * If enabled through the 'enable_live_network_counts' filter, update the users count
 * on a network when a user is created or its status is updated.
 *
 * @since 3.7.0
 *
 * @uses wp_update_network_user_counts()
 */
function wp_maybe_update_network_user_counts() {
	$is_small_network = ! wp_is_large_network( 'users' );

	/** This filter is documented in wp-includes/ms-functions.php */
	if ( ! apply_filters( 'enable_live_network_counts', $is_small_network, 'users' ) )
		return;

	wp_update_network_user_counts();
}

























































































































/**
 * Whether or not we have a large network.
 *
 * The default criteria for a large network is either more than 10,000 users or more than 10,000 sites.
 * Plugins can alter this criteria using the 'wp_is_large_network' filter.
 *
 * @since 3.3.0
 * @param string $using 'sites or 'users'. Default is 'sites'.
 * @return bool True if the network meets the criteria for large. False otherwise.
 */
function wp_is_large_network( $using = 'sites' ) {
	if ( 'users' == $using ) {
		$count = get_user_count();
		/**
		 * Filter whether the network is considered large.
		 *
		 * @since 3.3.0
		 *
		 * @param bool   $is_large_network Whether the network has more than 10000 users or sites.
		 * @param string $component        The component to count. Accepts 'users', or 'sites'.
		 * @param int    $count            The count of items for the component.
		 */
		return apply_filters( 'wp_is_large_network', $count > 10000, 'users', $count );
	}

	$count = get_blog_count();
	/** This filter is documented in wp-includes/ms-functions.php */
	return apply_filters( 'wp_is_large_network', $count > 10000, 'sites', $count );
}
